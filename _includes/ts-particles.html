<div id="tsparticles"></div>

<script src="https://cdn.jsdelivr.net/npm/tsparticles@2.11.1/tsparticles.bundle.min.js"></script>

<script>
  var PARTICLES_OPACITY = 0.25;

  var PARTICLES_OPTIONS = {
    autoPlay: true,
    background: {
      color: { value: sessionStorage.mode === 'dark' || (!!!sessionStorage.mode && window.matchMedia('(prefers-color-scheme: dark)').matches) ? '#1b1b1e' : '#fff' }
    },
    // fpsLimit: 120,
    particles: {
      number: {
        value: 60,
        density: { enable: true, value_area: 2000 }
      },
      color: { value: 'random' },
      shape: {
        type: 'circle',
        stroke: { width: 0, color: '#000000' }
      },
      opacity: {
        value: PARTICLES_OPACITY,
        random: false,
        anim: { enable: false, speed: 1, opacity_min: 0.1, sync: false }
      },
      size: {
        value: 5,
        random: true,
        anim: { enable: false, speed: 40, size_min: 0.1, sync: false }
      },
      line_linked: { color: '#757575e6', enable: true, opacity: PARTICLES_OPACITY, width: 1 },
      move: {
        enable: true,
        speed: 2,
        direction: 'none',
        random: true,
        straight: false,
        out_mode: 'out',
        attract: { enable: true, rotateX: 600, rotateY: 1200 }
      }
    },
    interactivity: {
      detect_on: 'canvas',
      events: {
        onhover: { enable: true, mode: 'grab' },
        onclick: { enable: false, mode: 'push' },
        resize: true
      },
      modes: {
        grab: {
          distance: 400,
          line_linked: { opacity: PARTICLES_OPACITY }
        },
        bubble: { distance: 400, size: 40, duration: 2, opacity: 8, speed: 3 },
        repulse: { distance: 200 },
        push: { particles_nb: 4 },
        remove: { particles_nb: 2 }
      }
    },
    detectRetina: true
  };

  tsParticles.load({
    id: "tsparticles",
    options: PARTICLES_OPTIONS
  });

  addEventListener('message', (event) => {
    if (
      event.source === window &&
      event.data &&
      event.data.direction === ModeToggle.ID
    ) {
      /* global theme mode changed */
      const mode = event.data.message;
      PARTICLES_OPTIONS.background.color.value = mode === ModeToggle.DARK_MODE ? '#1b1b1e' : '#fff';

      tsParticles.load({
        id: "tsparticles",
        options: PARTICLES_OPTIONS
      });
    }
  });

</script>